{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mcmm6\\\\Desktop\\\\subo-hems\\\\frontend\\\\src\\\\pages\\\\KitchenDispatch.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport '../styles/pages.css';\n\n// Use the current hostname/IP for API calls\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst getAPIBaseURL = () => {\n  const host = window.location.hostname;\n  const port = 5000;\n  return `http://${host}:${port}/api`;\n};\nconst API_BASE_URL = getAPIBaseURL();\nfunction KitchenDispatch() {\n  _s();\n  const [orders, setOrders] = useState([]);\n  const [activeTab, setActiveTab] = useState('pending');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [checkedItems, setCheckedItems] = useState({});\n  const [previousOrderCount, setPreviousOrderCount] = useState(-1);\n  const [previousOrderIds, setPreviousOrderIds] = useState(new Set());\n  const [newOrderAlert, setNewOrderAlert] = useState(false);\n  const soundPlayedRef = React.useRef(false);\n  const isFirstLoadRef = React.useRef(true);\n  const playNotificationSound = () => {\n    try {\n      // Create audio context\n      const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n\n      // Resume audio context if it's suspended (required by modern browsers)\n      if (audioContext.state === 'suspended') {\n        audioContext.resume();\n      }\n      const now = audioContext.currentTime;\n\n      // Create a hotel bell-like sound with multiple frequencies\n      // Bell sound typically has a sharp attack and long decay\n\n      // Primary bell tone - higher frequency\n      const osc1 = audioContext.createOscillator();\n      const gain1 = audioContext.createGain();\n      osc1.connect(gain1);\n      gain1.connect(audioContext.destination);\n      osc1.frequency.value = 1200; // High bell frequency\n      osc1.type = 'sine';\n      gain1.gain.setValueAtTime(0.3, now);\n      gain1.gain.exponentialRampToValueAtTime(0.025, now + 1.5); // Longer decay\n      osc1.start(now);\n      osc1.stop(now + 1.5);\n\n      // Secondary harmonic - slightly lower\n      const osc2 = audioContext.createOscillator();\n      const gain2 = audioContext.createGain();\n      osc2.connect(gain2);\n      gain2.connect(audioContext.destination);\n      osc2.frequency.value = 900;\n      osc2.type = 'sine';\n      gain2.gain.setValueAtTime(0.2, now + 0.1);\n      gain2.gain.exponentialRampToValueAtTime(0.01, now + 1.5);\n      osc2.start(now + 0.1);\n      osc2.stop(now + 1.5);\n\n      // Add some brightness with a higher harmonic\n      const osc3 = audioContext.createOscillator();\n      const gain3 = audioContext.createGain();\n      osc3.connect(gain3);\n      gain3.connect(audioContext.destination);\n      osc3.frequency.value = 1600;\n      osc3.type = 'sine';\n      gain3.gain.setValueAtTime(0.15, now);\n      gain3.gain.exponentialRampToValueAtTime(0.005, now + 1.2);\n      osc3.start(now);\n      osc3.stop(now + 1.2);\n      console.log('Hotel bell notification sound played');\n    } catch (error) {\n      console.error('Error playing notification sound:', error);\n      // Fallback: try using a simple bell-like sound\n      try {\n        // Create a simple bell sound using a very basic Web Audio approach\n        const ctx = new (window.AudioContext || window.webkitAudioContext)();\n        const osc = ctx.createOscillator();\n        const gain = ctx.createGain();\n        osc.connect(gain);\n        gain.connect(ctx.destination);\n        osc.frequency.value = 1000;\n        gain.gain.setValueAtTime(1, ctx.currentTime);\n        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);\n        osc.start(ctx.currentTime);\n        osc.stop(ctx.currentTime + 0.5);\n      } catch (e) {\n        console.error('Fallback audio also failed:', e);\n      }\n    }\n  };\n  useEffect(() => {\n    console.log('KitchenDispatch mounted');\n    fetchOrders();\n    // Poll for new orders every 3 seconds\n    const interval = setInterval(fetchOrders, 3000);\n\n    // Enable audio on first user interaction (required by modern browsers)\n    const enableAudio = () => {\n      const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n      if (audioContext.state === 'suspended') {\n        audioContext.resume().then(() => {\n          console.log('Audio context resumed');\n        });\n      }\n      // Remove listener after first interaction\n      document.removeEventListener('click', enableAudio);\n      document.removeEventListener('touchstart', enableAudio);\n    };\n    document.addEventListener('click', enableAudio);\n    document.addEventListener('touchstart', enableAudio);\n    return () => {\n      clearInterval(interval);\n      document.removeEventListener('click', enableAudio);\n      document.removeEventListener('touchstart', enableAudio);\n    };\n  }, []);\n  const fetchOrders = async () => {\n    try {\n      const response = await axios.get(`${API_BASE_URL}/orders`);\n      const newOrders = response.data;\n\n      // Get current pending orders\n      const currentPendingOrders = newOrders.filter(o => o.status === 'pending');\n      const currentPendingCount = currentPendingOrders.length;\n      const currentOrderIds = new Set(currentPendingOrders.map(o => o.id));\n      console.log(`Fetched orders - Current: ${currentPendingCount}, Previous: ${previousOrderCount}`);\n      console.log('Current pending order IDs:', Array.from(currentOrderIds));\n      console.log('Previous pending order IDs:', Array.from(previousOrderIds));\n\n      // Check for new orders (on first load or when new orders are added)\n      if (isFirstLoadRef.current) {\n        // First load - just initialize without playing sound\n        console.log('First load - initializing order tracking');\n        isFirstLoadRef.current = false;\n        soundPlayedRef.current = false;\n      } else if (currentPendingCount > 0) {\n        // Check if there are any new order IDs that weren't there before\n        const hasNewOrders = Array.from(currentOrderIds).some(id => !previousOrderIds.has(id));\n        if (hasNewOrders && !soundPlayedRef.current) {\n          console.log('New order(s) detected!');\n          playNotificationSound();\n          soundPlayedRef.current = true;\n          setNewOrderAlert(true);\n          // Auto-dismiss alert after 3 seconds\n          setTimeout(() => setNewOrderAlert(false), 3000);\n        }\n      }\n\n      // Reset sound flag if all orders are completed\n      if (currentPendingCount === 0) {\n        soundPlayedRef.current = false;\n      }\n      setPreviousOrderCount(currentPendingCount);\n      setPreviousOrderIds(currentOrderIds);\n      setOrders(newOrders);\n\n      // Initialize checkedItems from server-side `prepared` flags\n      const initialChecked = {};\n      newOrders.forEach(order => {\n        if (order.items && Array.isArray(order.items)) {\n          order.items.forEach((item, idx) => {\n            if (item.prepared) {\n              initialChecked[`${order.id}-${idx}`] = true;\n            }\n          });\n        }\n      });\n      setCheckedItems(initialChecked);\n    } catch (err) {\n      setError('Failed to fetch orders');\n      console.error(err);\n    }\n  };\n  const handleCompleteOrder = async orderId => {\n    try {\n      await axios.put(`${API_BASE_URL}/orders/${orderId}`, {\n        status: 'completed'\n      });\n      fetchOrders();\n    } catch (err) {\n      setError('Failed to complete order');\n      console.error(err);\n    }\n  };\n  const handleResetOrder = async orderId => {\n    try {\n      await axios.put(`${API_BASE_URL}/orders/${orderId}`, {\n        status: 'pending'\n      });\n      // Clear checked items for this order\n      setCheckedItems(prev => {\n        const updated = {\n          ...prev\n        };\n        delete updated[orderId];\n        return updated;\n      });\n      fetchOrders();\n    } catch (err) {\n      setError('Failed to reset order');\n      console.error(err);\n    }\n  };\n  const toggleItemCheck = (orderId, itemIndex) => {\n    const key = `${orderId}-${itemIndex}`;\n    const newValue = !checkedItems[key];\n\n    // Optimistically update UI\n    setCheckedItems(prev => ({\n      ...prev,\n      [key]: newValue\n    }));\n\n    // Persist prepared state to backend\n    axios.patch(`${API_BASE_URL}/orders/${orderId}/items/${itemIndex}`, {\n      prepared: newValue\n    }).then(() => {\n      // Refresh orders to keep everything in sync\n      fetchOrders();\n    }).catch(err => {\n      console.error('Failed to update item prepared state', err);\n      // Revert optimistic update on error\n      setCheckedItems(prev => ({\n        ...prev,\n        [key]: !newValue\n      }));\n    });\n  };\n  const areAllItemsChecked = (orderId, itemCount) => {\n    for (let i = 0; i < itemCount; i++) {\n      if (!checkedItems[`${orderId}-${i}`]) {\n        return false;\n      }\n    }\n    return true;\n  };\n  const filteredOrders = orders.filter(order => order.status === activeTab);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"page-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Kitchen Dispatch\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 7\n    }, this), newOrderAlert && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"new-order-alert\",\n      children: \"\\uD83D\\uDD14 New Order Received!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tabs\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab ${activeTab === 'pending' ? 'active' : ''}`,\n        onClick: () => setActiveTab('pending'),\n        children: [\"Pending Orders (\", orders.filter(o => o.status === 'pending').length, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab ${activeTab === 'completed' ? 'active' : ''}`,\n        onClick: () => setActiveTab('completed'),\n        children: [\"Completed Orders (\", orders.filter(o => o.status === 'completed').length, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"orders-container\",\n      children: [loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: \"Loading orders...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 21\n      }, this), filteredOrders.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"empty-state\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"No \", activeTab, \" orders\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 11\n      }, this), filteredOrders.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"orders-list\",\n        children: filteredOrders.map(order => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `order-card order-${order.status}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"order-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"order-header-content\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"table-number\",\n                children: [\"Table \", order.tableNumber]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 291,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"order-number\",\n                children: order.orderNumber\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: `status-badge status-${order.status}`,\n              children: order.status.charAt(0).toUpperCase() + order.status.slice(1)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"order-items\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Items:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: order.items.map((item, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n                className: order.status === 'pending' ? 'kitchen-item' : '',\n                children: [order.status === 'pending' && /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  id: `item-${order.id}-${idx}`,\n                  checked: checkedItems[`${order.id}-${idx}`] || false,\n                  onChange: () => toggleItemCheck(order.id, idx),\n                  className: \"item-checkbox\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: order.status === 'pending' ? `item-${order.id}-${idx}` : '',\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: [item.quantity, \"x \", item.name]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 314,\n                    columnNumber: 27\n                  }, this), item.notes && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"item-notes-kitchen\",\n                    children: [\"Note: \", item.notes]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 42\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 313,\n                  columnNumber: 25\n                }, this)]\n              }, idx, true, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"order-time\",\n            children: [/*#__PURE__*/_jsxDEV(\"small\", {\n              children: [\"Created: \", new Date(order.createdAt).toLocaleString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 19\n            }, this), order.status === 'completed' && order.completedAt && /*#__PURE__*/_jsxDEV(\"small\", {\n              children: [\"Completed: \", new Date(order.completedAt).toLocaleString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"order-actions\",\n            children: [order.status === 'pending' && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-success\",\n              onClick: () => handleCompleteOrder(order.id),\n              disabled: !areAllItemsChecked(order.id, order.items.length),\n              title: !areAllItemsChecked(order.id, order.items.length) ? 'Check all items first' : '',\n              children: \"\\u2713 Mark as Done\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 21\n            }, this), order.status === 'completed' && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-secondary\",\n              onClick: () => handleResetOrder(order.id),\n              children: \"Reset to Pending\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 17\n          }, this)]\n        }, order.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 250,\n    columnNumber: 5\n  }, this);\n}\n_s(KitchenDispatch, \"diZ+j7W15iv5cWSYJip4KHMTUDE=\");\n_c = KitchenDispatch;\nexport default KitchenDispatch;\nvar _c;\n$RefreshReg$(_c, \"KitchenDispatch\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","getAPIBaseURL","host","window","location","hostname","port","API_BASE_URL","KitchenDispatch","_s","orders","setOrders","activeTab","setActiveTab","loading","setLoading","error","setError","checkedItems","setCheckedItems","previousOrderCount","setPreviousOrderCount","previousOrderIds","setPreviousOrderIds","Set","newOrderAlert","setNewOrderAlert","soundPlayedRef","useRef","isFirstLoadRef","playNotificationSound","audioContext","AudioContext","webkitAudioContext","state","resume","now","currentTime","osc1","createOscillator","gain1","createGain","connect","destination","frequency","value","type","gain","setValueAtTime","exponentialRampToValueAtTime","start","stop","osc2","gain2","osc3","gain3","console","log","ctx","osc","e","fetchOrders","interval","setInterval","enableAudio","then","document","removeEventListener","addEventListener","clearInterval","response","get","newOrders","data","currentPendingOrders","filter","o","status","currentPendingCount","length","currentOrderIds","map","id","Array","from","current","hasNewOrders","some","has","setTimeout","initialChecked","forEach","order","items","isArray","item","idx","prepared","err","handleCompleteOrder","orderId","put","handleResetOrder","prev","updated","toggleItemCheck","itemIndex","key","newValue","patch","catch","areAllItemsChecked","itemCount","i","filteredOrders","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","tableNumber","orderNumber","charAt","toUpperCase","slice","checked","onChange","htmlFor","quantity","name","notes","Date","createdAt","toLocaleString","completedAt","disabled","title","_c","$RefreshReg$"],"sources":["C:/Users/mcmm6/Desktop/subo-hems/frontend/src/pages/KitchenDispatch.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport '../styles/pages.css';\r\n\r\n// Use the current hostname/IP for API calls\r\nconst getAPIBaseURL = () => {\r\n  const host = window.location.hostname;\r\n  const port = 5000;\r\n  return `http://${host}:${port}/api`;\r\n};\r\n\r\nconst API_BASE_URL = getAPIBaseURL();\r\n\r\nfunction KitchenDispatch() {\r\n  const [orders, setOrders] = useState([]);\r\n  const [activeTab, setActiveTab] = useState('pending');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [checkedItems, setCheckedItems] = useState({});\r\n  const [previousOrderCount, setPreviousOrderCount] = useState(-1);\r\n  const [previousOrderIds, setPreviousOrderIds] = useState(new Set());\r\n  const [newOrderAlert, setNewOrderAlert] = useState(false);\r\n  const soundPlayedRef = React.useRef(false);\r\n  const isFirstLoadRef = React.useRef(true);\r\n\r\n  const playNotificationSound = () => {\r\n    try {\r\n      // Create audio context\r\n      const audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\n      \r\n      // Resume audio context if it's suspended (required by modern browsers)\r\n      if (audioContext.state === 'suspended') {\r\n        audioContext.resume();\r\n      }\r\n      \r\n      const now = audioContext.currentTime;\r\n      \r\n      // Create a hotel bell-like sound with multiple frequencies\r\n      // Bell sound typically has a sharp attack and long decay\r\n      \r\n      // Primary bell tone - higher frequency\r\n      const osc1 = audioContext.createOscillator();\r\n      const gain1 = audioContext.createGain();\r\n      osc1.connect(gain1);\r\n      gain1.connect(audioContext.destination);\r\n      osc1.frequency.value = 1200; // High bell frequency\r\n      osc1.type = 'sine';\r\n      gain1.gain.setValueAtTime(0.3, now);\r\n      gain1.gain.exponentialRampToValueAtTime(0.025, now + 1.5); // Longer decay\r\n      osc1.start(now);\r\n      osc1.stop(now + 1.5);\r\n      \r\n      // Secondary harmonic - slightly lower\r\n      const osc2 = audioContext.createOscillator();\r\n      const gain2 = audioContext.createGain();\r\n      osc2.connect(gain2);\r\n      gain2.connect(audioContext.destination);\r\n      osc2.frequency.value = 900;\r\n      osc2.type = 'sine';\r\n      gain2.gain.setValueAtTime(0.2, now + 0.1);\r\n      gain2.gain.exponentialRampToValueAtTime(0.01, now + 1.5);\r\n      osc2.start(now + 0.1);\r\n      osc2.stop(now + 1.5);\r\n      \r\n      // Add some brightness with a higher harmonic\r\n      const osc3 = audioContext.createOscillator();\r\n      const gain3 = audioContext.createGain();\r\n      osc3.connect(gain3);\r\n      gain3.connect(audioContext.destination);\r\n      osc3.frequency.value = 1600;\r\n      osc3.type = 'sine';\r\n      gain3.gain.setValueAtTime(0.15, now);\r\n      gain3.gain.exponentialRampToValueAtTime(0.005, now + 1.2);\r\n      osc3.start(now);\r\n      osc3.stop(now + 1.2);\r\n      \r\n      console.log('Hotel bell notification sound played');\r\n    } catch (error) {\r\n      console.error('Error playing notification sound:', error);\r\n      // Fallback: try using a simple bell-like sound\r\n      try {\r\n        // Create a simple bell sound using a very basic Web Audio approach\r\n        const ctx = new (window.AudioContext || window.webkitAudioContext)();\r\n        const osc = ctx.createOscillator();\r\n        const gain = ctx.createGain();\r\n        osc.connect(gain);\r\n        gain.connect(ctx.destination);\r\n        osc.frequency.value = 1000;\r\n        gain.gain.setValueAtTime(1, ctx.currentTime);\r\n        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);\r\n        osc.start(ctx.currentTime);\r\n        osc.stop(ctx.currentTime + 0.5);\r\n      } catch (e) {\r\n        console.error('Fallback audio also failed:', e);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log('KitchenDispatch mounted');\r\n    fetchOrders();\r\n    // Poll for new orders every 3 seconds\r\n    const interval = setInterval(fetchOrders, 3000);\r\n    \r\n    // Enable audio on first user interaction (required by modern browsers)\r\n    const enableAudio = () => {\r\n      const audioContext = new (window.AudioContext || window.webkitAudioContext)();\r\n      if (audioContext.state === 'suspended') {\r\n        audioContext.resume().then(() => {\r\n          console.log('Audio context resumed');\r\n        });\r\n      }\r\n      // Remove listener after first interaction\r\n      document.removeEventListener('click', enableAudio);\r\n      document.removeEventListener('touchstart', enableAudio);\r\n    };\r\n    \r\n    document.addEventListener('click', enableAudio);\r\n    document.addEventListener('touchstart', enableAudio);\r\n    \r\n    return () => {\r\n      clearInterval(interval);\r\n      document.removeEventListener('click', enableAudio);\r\n      document.removeEventListener('touchstart', enableAudio);\r\n    };\r\n  }, []);\r\n\r\n  const fetchOrders = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/orders`);\r\n      const newOrders = response.data;\r\n      \r\n      // Get current pending orders\r\n      const currentPendingOrders = newOrders.filter(o => o.status === 'pending');\r\n      const currentPendingCount = currentPendingOrders.length;\r\n      const currentOrderIds = new Set(currentPendingOrders.map(o => o.id));\r\n      \r\n      console.log(`Fetched orders - Current: ${currentPendingCount}, Previous: ${previousOrderCount}`);\r\n      console.log('Current pending order IDs:', Array.from(currentOrderIds));\r\n      console.log('Previous pending order IDs:', Array.from(previousOrderIds));\r\n      \r\n      // Check for new orders (on first load or when new orders are added)\r\n      if (isFirstLoadRef.current) {\r\n        // First load - just initialize without playing sound\r\n        console.log('First load - initializing order tracking');\r\n        isFirstLoadRef.current = false;\r\n        soundPlayedRef.current = false;\r\n      } else if (currentPendingCount > 0) {\r\n        // Check if there are any new order IDs that weren't there before\r\n        const hasNewOrders = Array.from(currentOrderIds).some(id => !previousOrderIds.has(id));\r\n        \r\n        if (hasNewOrders && !soundPlayedRef.current) {\r\n          console.log('New order(s) detected!');\r\n          playNotificationSound();\r\n          soundPlayedRef.current = true;\r\n          setNewOrderAlert(true);\r\n          // Auto-dismiss alert after 3 seconds\r\n          setTimeout(() => setNewOrderAlert(false), 3000);\r\n        }\r\n      }\r\n      \r\n      // Reset sound flag if all orders are completed\r\n      if (currentPendingCount === 0) {\r\n        soundPlayedRef.current = false;\r\n      }\r\n      \r\n      setPreviousOrderCount(currentPendingCount);\r\n      setPreviousOrderIds(currentOrderIds);\r\n      setOrders(newOrders);\r\n\r\n      // Initialize checkedItems from server-side `prepared` flags\r\n      const initialChecked = {};\r\n      newOrders.forEach(order => {\r\n        if (order.items && Array.isArray(order.items)) {\r\n          order.items.forEach((item, idx) => {\r\n            if (item.prepared) {\r\n              initialChecked[`${order.id}-${idx}`] = true;\r\n            }\r\n          });\r\n        }\r\n      });\r\n      setCheckedItems(initialChecked);\r\n    } catch (err) {\r\n      setError('Failed to fetch orders');\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const handleCompleteOrder = async (orderId) => {\r\n    try {\r\n      await axios.put(`${API_BASE_URL}/orders/${orderId}`, { status: 'completed' });\r\n      fetchOrders();\r\n    } catch (err) {\r\n      setError('Failed to complete order');\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const handleResetOrder = async (orderId) => {\r\n    try {\r\n      await axios.put(`${API_BASE_URL}/orders/${orderId}`, { status: 'pending' });\r\n      // Clear checked items for this order\r\n      setCheckedItems(prev => {\r\n        const updated = { ...prev };\r\n        delete updated[orderId];\r\n        return updated;\r\n      });\r\n      fetchOrders();\r\n    } catch (err) {\r\n      setError('Failed to reset order');\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const toggleItemCheck = (orderId, itemIndex) => {\r\n    const key = `${orderId}-${itemIndex}`;\r\n    const newValue = !checkedItems[key];\r\n\r\n    // Optimistically update UI\r\n    setCheckedItems(prev => ({\r\n      ...prev,\r\n      [key]: newValue\r\n    }));\r\n\r\n    // Persist prepared state to backend\r\n    axios.patch(`${API_BASE_URL}/orders/${orderId}/items/${itemIndex}`, { prepared: newValue })\r\n      .then(() => {\r\n        // Refresh orders to keep everything in sync\r\n        fetchOrders();\r\n      })\r\n      .catch(err => {\r\n        console.error('Failed to update item prepared state', err);\r\n        // Revert optimistic update on error\r\n        setCheckedItems(prev => ({ ...prev, [key]: !newValue }));\r\n      });\r\n  };\r\n\r\n  const areAllItemsChecked = (orderId, itemCount) => {\r\n    for (let i = 0; i < itemCount; i++) {\r\n      if (!checkedItems[`${orderId}-${i}`]) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const filteredOrders = orders.filter(order => order.status === activeTab);\r\n\r\n  return (\r\n    <div className=\"page-container\">\r\n      <h2>Kitchen Dispatch</h2>\r\n      \r\n      {newOrderAlert && (\r\n        <div className=\"new-order-alert\">\r\n          ðŸ”” New Order Received!\r\n        </div>\r\n      )}\r\n      \r\n      {error && <div className=\"error-message\">{error}</div>}\r\n\r\n      <div className=\"tabs\">\r\n        <button\r\n          className={`tab ${activeTab === 'pending' ? 'active' : ''}`}\r\n          onClick={() => setActiveTab('pending')}\r\n        >\r\n          Pending Orders ({orders.filter(o => o.status === 'pending').length})\r\n        </button>\r\n        <button\r\n          className={`tab ${activeTab === 'completed' ? 'active' : ''}`}\r\n          onClick={() => setActiveTab('completed')}\r\n        >\r\n          Completed Orders ({orders.filter(o => o.status === 'completed').length})\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"orders-container\">\r\n        {loading && <div className=\"loading\">Loading orders...</div>}\r\n        \r\n        {filteredOrders.length === 0 && (\r\n          <div className=\"empty-state\">\r\n            <p>No {activeTab} orders</p>\r\n          </div>\r\n        )}\r\n\r\n        {filteredOrders.length > 0 && (\r\n          <div className=\"orders-list\">\r\n            {filteredOrders.map(order => (\r\n              <div key={order.id} className={`order-card order-${order.status}`}>\r\n                <div className=\"order-header\">\r\n                  <div className=\"order-header-content\">\r\n                    <h3 className=\"table-number\">Table {order.tableNumber}</h3>\r\n                    <p className=\"order-number\">{order.orderNumber}</p>\r\n                  </div>\r\n                  <span className={`status-badge status-${order.status}`}>\r\n                    {order.status.charAt(0).toUpperCase() + order.status.slice(1)}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"order-items\">\r\n                  <h4>Items:</h4>\r\n                  <ul>\r\n                    {order.items.map((item, idx) => (\r\n                      <li key={idx} className={order.status === 'pending' ? 'kitchen-item' : ''}>\r\n                        {order.status === 'pending' && (\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            id={`item-${order.id}-${idx}`}\r\n                            checked={checkedItems[`${order.id}-${idx}`] || false}\r\n                            onChange={() => toggleItemCheck(order.id, idx)}\r\n                            className=\"item-checkbox\"\r\n                          />\r\n                        )}\r\n                        <label htmlFor={order.status === 'pending' ? `item-${order.id}-${idx}` : ''}>\r\n                          <strong>{item.quantity}x {item.name}</strong>\r\n                          {item.notes && <div className=\"item-notes-kitchen\">Note: {item.notes}</div>}\r\n                        </label>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n\r\n                <div className=\"order-time\">\r\n                  <small>Created: {new Date(order.createdAt).toLocaleString()}</small>\r\n                  {order.status === 'completed' && order.completedAt && (\r\n                    <small>Completed: {new Date(order.completedAt).toLocaleString()}</small>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"order-actions\">\r\n                  {order.status === 'pending' && (\r\n                    <button\r\n                      className=\"btn btn-success\"\r\n                      onClick={() => handleCompleteOrder(order.id)}\r\n                      disabled={!areAllItemsChecked(order.id, order.items.length)}\r\n                      title={!areAllItemsChecked(order.id, order.items.length) ? 'Check all items first' : ''}\r\n                    >\r\n                      âœ“ Mark as Done\r\n                    </button>\r\n                  )}\r\n                  {order.status === 'completed' && (\r\n                    <button\r\n                      className=\"btn btn-secondary\"\r\n                      onClick={() => handleResetOrder(order.id)}\r\n                    >\r\n                      Reset to Pending\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default KitchenDispatch;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}